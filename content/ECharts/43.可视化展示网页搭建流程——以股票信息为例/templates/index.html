<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>股票实时查询可视化展示网页</title>
    <script src="{{ url_for('static',filename='echarts.js') }}"></script>
</head>

<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <center>
        <form id="form" name="form" method='POST' action='/' style="text-alige:left">
            <h4>请输入需要查询股票代码:
                <input type="text" name="name" style="height:20px;width:160px;font-size:20px;">
                <input type="submit" value="点击查询">
            <h4>
        </form>
        <div id="main" style="width:1500px;height:750px;alige:center"></div>
        <!-- ECharts单文件引入 -->
        <script type="text/javascript">
        // 基于准备好的dom，初始化echarts图表
        var myChart = echarts.init(document.getElementById('main'));
        var option = {
            title: [{
                    text: '{{info_return['company_name']|tojson}} - {{info_return['company_code']|tojson}}\n近30交易日涨跌天数：{{data_return['rise_fall_count'][0]|tojson}}天(涨) - {{data_return['rise_fall_count'][1]|tojson}}天(跌)',
                    x: '50%',
                    y: '2%',
                    textAlign: 'center',
                    textBaseline: 'middle',
                    textStyle: {
                        fontSize: 20,
                        color:'#F36100'
                    }
                },{
                    text: '近30交易日成交额 （千元）',
                    x: '20.8%',
                    y: '9%',
                    textAlign: 'center',
                    textBaseline: 'middle',
                    textStyle: {
                        fontSize: 20
                    }
                },{
                    text: '近30交易日成交量（手）',
                    x: '73%',
                    y: '9%',
                    textAlign: 'center',
                    textBaseline: 'middle',
                    textStyle: {
                        fontSize: 20
                    }
                },{
                    text: '近30个交易日收盘价',
                    x: '20.8%',
                    y: '55%',
                    textAlign: 'center',
                    textBaseline: 'middle',
                    textStyle: {
                        fontSize: 20
                    }
                },{
                    text: '近30交易日涨跌额变化',
                    x: '73%',
                    y: '55%',
                    textAlign: 'center',
                    textBaseline: 'middle',
                    textStyle: {
                        fontSize: 20
                    }
                },
            ],

            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },

            grid: [{
                    gridindex: 0,
                    left: '5%',
                    right: '55%',
                    top: '17%',
                    bottom: '55%',
                    containLabel: true
                },{
                    gridindex: 1,
                    left: '50%',
                    right: '5%',
                    top: '17%',
                    bottom: '55%',
                    containLabel: true
                },{
                gridindex: 2,
                    left: '5%',
                    right: '55%',
                    top: '60%',
                    bottom: '5%',
                    containLabel: true
                },
                {
                    gridindex: 3,
                    left: '50%',
                    right: '5%',
                    top: '60%',
                    bottom: '5%',
                    containLabel: true
                } 
            ],

            xAxis: [{
                    gridIndex: 0,
                    type: 'category',
                    boundaryGap: false,
                    data: {{data_return['x_index']|tojson}}
                },{
                    gridIndex: 1,
                    type: 'category',
                    boundaryGap: false,
                    data: {{data_return['x_index']|tojson}}
                },{
                gridIndex: 2,
                    type: 'category',
                    data: {{data_return['x_index']|tojson}},
                    axisLabel: {
                        interval: 0,
                        rotate: 90
                    },
                },{
                    gridIndex: 3,
                    type: 'category',
                    boundaryGap: false,
                    data: {{data_return['x_index']|tojson}}
                }
                
            ],

            yAxis: [{
                    gridIndex: 0,
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} '
                    }
                },{
                    gridIndex: 1,
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} '
                    }
                },{
                gridIndex: 2,
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} '
                    },
                    boundaryGap: [0, 0.02]
                },{
                    gridIndex: 3,
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} '
                    }
                }],

            series: [
                {
                    name: '',
                    type: 'bar',
                    xAxisIndex: 0,
                    yAxisIndex: 0,
                    label: {
                        show: true,
                        position: 'top',
                        rotate: 90,
                        show: false
                    },
                    data: {{data_return['amount']|tojson}}
                },{
                    name: '',
                    type: 'bar',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    label: {
                        show: true,
                        position: 'top',
                        rotate: 90,
                        show: false
                    },
                    data: {{data_return['volume']|tojson}}
                },
                
                {
                    xAxisIndex: 2,
                    yAxisIndex: 2,
                    name: '',
                    type: 'line',
                    data: {{data_return['close_value']|tojson}},
                    smooth: true,
                    markPoint: {
                        data: [{
                                type: 'max',
                                name: '最大值',
                                symbolSize: 40
                            },
                            {
                                type: 'min',
                                name: '最小值',
                                symbolSize: 40
                            }
                        ],
                    },
                },
                {
                    xAxisIndex: 3,
                    yAxisIndex: 3,
                    name: '',
                    type: 'line',
                    data: {{data_return['price_change']|tojson }},
                    // smooth: true,
                    markPoint: {
                        data: [{
                                type: 'max',
                                name: '最大值',
                                symbolSize: 40
                            },
                            {
                                type: 'min',
                                name: '最小值',
                                symbolSize: 40
                            }
                        ],
                    },
                }
            ]
        };
        // 为echarts对象加载数据 
        myChart.setOption(option);
        </script>
    </center>
</body>

</html>